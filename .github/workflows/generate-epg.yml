name: Generate EPG

on:
  schedule:
    - cron: '0 3 * * *'  # TÃ¤glich um 03:00 Uhr UTC
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4

      - name: Install Mono & WebGrab++
        run: |
          sudo apt-get update
          sudo apt-get install -y mono-complete wget
          wget https://softpedia-secure-download.com/dl/8d54a7a0cb6f6ebafe730466db31ca17/68c34c1a/100265333/software/other_tools/WebGrabPlus_V5.3_install.exe
          
          mkdir -p ~/webgrab
          mv WebGrabPlus_V5.3_install.exe ~/webgrab/

      - name: Copy Config & SiteIni
        run: |
          cp config/WebGrab++.config.xml ~/webgrab/
          cp siteini/*.ini ~/webgrab/

      - name: Run WebGrab++
        run: mono ~/webgrab/WebGrabPlus_V5.3_install.exe
          

      - name: Upload guide.xml
        uses: actions/upload-artifact@v4
        with:
          name: epg
          path: ~/webgrab/guide.xml
